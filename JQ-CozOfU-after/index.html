<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Coz Of U--商品管理后台</title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/sb-admin.css" rel="stylesheet">
    <link href="css/plugins/morris.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!--[if lt IE 9]>
    <!--<scripts src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></scripts>
    <scripts src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></scripts>-->
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="css/xcConfirm.css"/>
    <script src="js/xcConfirm.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>

<div id="wrapper">

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">

        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">Coz Of U</a>
        </div>
        <!-- Top Menu Items -->
        <ul class="nav navbar-right top-nav">
            <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-envelope"></i> <b class="caret"></b></a>
                <ul class="dropdown-menu message-dropdown">
                    <li class="message-preview">
                        <a href="#">
                            <div class="media">
                                    <span class="pull-left">
                                        <img class="media-object" src="http://placehold.it/50x50" alt="">
                                    </span>
                                <div class="media-body">
                                    <h5 class="media-heading"><strong>cxx</strong>
                                    </h5>
                                    <p class="small text-muted"><i class="fa fa-clock-o"></i> Yesterday at 4:32 PM</p>
                                    <p>Lorem ipsum dolor sit amet, consectetur...</p>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li class="message-preview">
                        <a href="#">
                            <div class="media">
                                    <span class="pull-left">
                                        <img class="media-object" src="http://placehold.it/50x50" alt="">
                                    </span>
                                <div class="media-body">
                                    <h5 class="media-heading"><strong>cxx</strong>
                                    </h5>
                                    <p class="small text-muted"><i class="fa fa-clock-o"></i> Yesterday at 4:32 PM</p>
                                    <p>Lorem ipsum dolor sit amet, consectetur...</p>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li class="message-preview">
                        <a href="#">
                            <div class="media">
                                    <span class="pull-left">
                                        <img class="media-object" src="http://placehold.it/50x50" alt="">
                                    </span>
                                <div class="media-body">
                                    <h5 class="media-heading"><strong>cxx</strong>
                                    </h5>
                                    <p class="small text-muted"><i class="fa fa-clock-o"></i> Yesterday at 4:32 PM</p>
                                    <p>Lorem ipsum dolor sit amet, consectetur...</p>
                                </div>
                            </div>
                        </a>
                    </li>
                    <li class="message-footer">
                        <a href="#">Read All New Messages</a>
                    </li>
                </ul>
            </li>
            <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bell"></i> <b class="caret"></b></a>
                <ul class="dropdown-menu alert-dropdown">
                    <li>
                        <a href="#">Alert Name <span class="label label-default">Alert Badge</span></a>
                    </li>
                    <li>
                        <a href="#">Alert Name <span class="label label-primary">Alert Badge</span></a>
                    </li>
                    <li>
                        <a href="#">Alert Name <span class="label label-success">Alert Badge</span></a>
                    </li>
                    <li>
                        <a href="#">Alert Name <span class="label label-info">Alert Badge</span></a>
                    </li>
                    <li>
                        <a href="#">Alert Name <span class="label label-warning">Alert Badge</span></a>
                    </li>
                    <li>
                        <a href="#">Alert Name <span class="label label-danger">Alert Badge</span></a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="#">View All</a>
                    </li>
                </ul>
            </li>
            <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user"></i> cxx <b class="caret"></b></a>
                <ul class="dropdown-menu">
                    <li>
                        <a href="#"><i class="fa fa-fw fa-user"></i> Profile</a>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-fw fa-envelope"></i> Inbox</a>
                    </li>
                    <li>
                        <a href="#"><i class="fa fa-fw fa-gear"></i> Settings</a>
                    </li>
                    <li class="divider"></li>
                    <li>
                        <a href="#"><i class="fa fa-fw fa-power-off"></i> Log Out</a>
                    </li>
                </ul>
            </li>
        </ul>
        <!-- Sidebar Menu Items - These collapse to the responsive navigation menu on small screens -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav side-nav">
                <li class="active">
                    <a href="index.html" ><i class="fa fa-fw fa-table"></i>商品管理</a>
                </li>
                <li>
                    <a href="javascript:;" data-toggle="collapse" data-target="#demo"><i class="fa fa-fw fa-arrows-v"></i>商品分类<i class="fa fa-fw fa-caret-down"></i></a>
                    <ul id="demo" class="collapse">
                        <li>
                            <a href="xiangce.html?id=0" >相册</a>
                        </li>
                        <li>
                            <a href="xiangce.html?id=1" >相框</a>
                        </li>
                        <li>
                            <a href="xiangce.html?id=2" >鞋子</a>
                        </li>

                    </ul>
                </li>
                <li class="active">
                    <a href="common.html" ><i class="fa fa-fw fa-table"></i>用户管理</a>
                </li>
            </ul>
        </div>
    </nav>

    <div id="page-wrapper">
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">
                        商品管理
                    </h1>
                    <ol class="breadcrumb">

                        <li class="active">
                            Coz Of U
                        </li>
                        <li class="active">
                            <i class="fa fa-table"></i> 商品管理
                        </li>
                    </ol>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <h2>Product details</h2>

                    <div class="table-responsive">
                        <table class="table table-bordered table-hover table-striped">
                            <thead>
                            <tr>
                                <th>ID</th>
                                <th>Pic</th>
                                <th>Name</th>
                                <th>Count</th>
                                <th>Price</th>
                                <th>Change</th>
                            </tr>
                            </thead>
                            <tbody id="otbody">
                            </tbody>
                        </table>
                        <form class="yeshu">
                        </form>
                    </div>
                </div>
            </div>
            <!-- /.row -->
        </div>
    </div>
</div>
<script>
    var page = 1;
    var num = 1;
    getAllPage();
    function getAllPage() {
        var count = 0;
        $.ajax({
            url: "../product/GetProductsByPage_get?pagesize=100&pageindex=1",
            success: function (data) {
                for (var i = 0; i < data.length; i++) {
                    if (data[i].Type != "50"&&data[i].Type != "60") {
                        count++;
                    }
                }
                getPage(count);
            },
            dataType: "json"
        });
    }
    function getPage(x) {
        num = Math.ceil(x / 6);
        $(".yeshu").html("");
        $(".yeshu").append("<input id=\"bts\" type=\"button\" value=\"上一页\"/>");
        for (var i = 0; i < num; i++) {
            $(".yeshu").append("<input type=\"button\" value=\"" + (i + 1) + "\"/>");
        }
        $(".yeshu").append("<input id=\"btx\" type=\"button\" value=\"下一页\"/>");
    }

    goods("../product/GetProductsByPage_get", page);
    $(".yeshu").on("click", "input", function () {
        if ($(this).val() == "上一页") {
            if (page != 1) {
                page--;
            } else {
                alert("当前页为首页");
            }
        } else if ($(this).val() == "下一页") {
            if (page != num) {
                page++;
            } else {
                alert("当前页为最后一页");
            }
        } else {
            page = parseInt($(this).val());
        }
        goods("../product/GetProductsByPage_get", page);
    });

    function goods(url, page) {
        $.ajax({
            url: url,
            data: {
                "pagesize": 6,
                "pageindex": page + 1
            },
            success: function (data) {
                $("#otbody").html("");
                jiazai(data);
            },
            dataType: "json"
        });
    }
    function jiazai(data) {
        for (var i = 0; i < data.length; i++) {
            if (data[i].Type != 50&&data[i].Type != 60) {
                var dataObj = JSON.parse(data[i].Data);
                var html = "<tr>";
                switch (i) {
                    case 0:
                        html = "<tr class=\"warning\">";
                        break;
                    case 2:
                        html = "<tr class=\"success\">";
                        break;
                    case 5:
                        html = "<tr class=\"danger\">";
                        break;
                }
                html += "<td>" + dataObj.id + "</td><td><img id=\"srcimg\" style=\"width:50px;height:50px;\" src=\"../JQ-CozOfU/" + dataObj.imgsrc1 + "\" alt=\"img\"/></td><td>" + dataObj.name + "</td><td>" + dataObj.count + "</td><td>" + dataObj.price + "</td><td><input id=\"tianjia\"  type=\"button\" value=\"添加\"/><input id=\"xiugai\"  type=\"button\" value=\"修改\"/></a><a id=\"del\" href=\"javascript:void(0)\">删除</a></td></tr>";
                $("#otbody").append(html);
            }
        }
    }
    $("#otbody").on("click", "#del", function () {
        var id = $(this).parent().parent().children().html();
        $.ajax({
            url: "../../product/DeleteProductById_get?id=" + id,
            success: function () {
                goods("../product/GetProductsByPage_get", page);
            }
        });
    });
    $("#otbody").on("click", "#tianjia", function () {
        var txt = "ID:<input class=\"id1\"/>" +
                "Pic:<input class=\"pic1\"/>" +
                "Name:<input class=\"name1\"/>" +
                "Count:<input class=\"count1\"/>" +
                "attr:<input class=\"attr1\"/>" +
                "caizhi:<input class=\"caizhi1\"/>" +
                "size:<input class=\"size1\"/>" +
                "style:<input class=\"style1\"/>" +
                "Price:<input class=\"price1\"/>" +
                "Type:<input class=\"type1\"/>";
        var option = {
            title: "添加数据",
            btn: parseInt("0011", 2),
            onOk: function () {
                var id = $(".id1").val();
                var ajaxurl = "../product/CreateUpdateProduct_get";
                var ajaxDataJson = {
                    id: id,
                    name: $(".name1").val(),
                    imgsrc1: $(".pic1").val(),
                    imgsrc2: $(".pic1").val(),
                    imgsrc3: $(".pic1").val(),
                    imgsrc4: $(".pic1").val(),
                    imgsrc5: $(".pic1").val(),
                    imgsrc6: $(".pic1").val(),
                    imgsrc7: $(".pic1").val(),
                    imgsrc8: $(".pic1").val(),
                    count: $(".count1").val(),
                    caizhi: $(".caizhi1").val(),
                    xingzhuang: $(".attr1").val(),
                    size: $(".size1").val(),
                    style: $(".style1").val(),
                    jieshao: "简约但不简单，低调却不低俗,我们认为，幸福纷纷扬扬，琐碎微小，只有迎着光、低下头才能察觉。",
                    price: $(".price1").val()
                }
                var dataStr = JSON.stringify(ajaxDataJson);
                $.ajax({
                    url: ajaxurl,
                    data: {
                        id: id,
                        datajson: dataStr,
                        type: $(".type1").val()
                    },

                    success: function () {
                        getAllPage();
                        page = num;
                        goods("../product/GetProductsByPage_get", page);
                    }
                });
            }
        }
        window.wxc.xcConfirm(txt, "custom", option);
    });
    $("#otbody").on("click", "#xiugai", function () {
        var id = $(this).parent().parent().children().html();
        //alert($(this).parent().parent().find("#srcimg").attr("src"));
        $.ajax({
            url: "../../product/GetProductById_get?id=" + id,
            success: function (data) {
                var dataObj=JSON.parse(data.Data);
                var txt = "ID:<input class=\"id1\" value=\"" + id + "\"/>" +
                        "Pic:<input class=\"pic1\" value=\"" + dataObj.imgsrc1+ "\"/>" +
                        "Name:<input class=\"name1\" value=\"" + dataObj.name+ "\"/>" +
                        "Count:<input class=\"count1\" value=\"" + dataObj.count+ "\"/>" +
                        "attr:<input class=\"attr1\" value=\"" + dataObj.xingzhuang+ "\"/>" +
                        "caizhi:<input class=\"caizhi1\" value=\"" + dataObj.caizhi+ "\"/>" +
                        "size:<input class=\"size1\" value=\"" + dataObj.size+ "\"/>" +
                        "style:<input class=\"style1\" value=\"" + dataObj.style+ "\"/>" +
                        "Price:<input class=\"price1\"  value=\"" + dataObj.price+ "\"/>" +
                        "Type:<input class=\"type1\" value=\"" + data.Type+ "\"/>";
                var option = {
                    title: "修改数据",
                    btn: parseInt("0011", 2),
                    onOk: function () {
                        var id = $(".id1").val();
                        var ajaxurl = "../product/CreateUpdateProduct_get";
                        var ajaxDataJson = {
                            id: id,
                            name: $(".name1").val(),
                            imgsrc1: $(".pic1").val(),
                            imgsrc2: $(".pic1").val(),
                            imgsrc3: $(".pic1").val(),
                            imgsrc4: $(".pic1").val(),
                            imgsrc5: $(".pic1").val(),
                            imgsrc6: $(".pic1").val(),
                            imgsrc7: $(".pic1").val(),
                            imgsrc8: $(".pic1").val(),
                            count: $(".count1").val(),
                            caizhi: $(".caizhi1").val(),
                            xingzhuang: $(".attr1").val(),
                            size: $(".size1").val(),
                            style: $(".style1").val(),
                            jieshao: "简约但不简单，低调却不低俗,我们认为，幸福纷纷扬扬，琐碎微小，只有迎着光、低下头才能察觉。",
                            price: $(".price1").val()
                        }
                        var dataStr = JSON.stringify(ajaxDataJson);
                        $.ajax({
                            url: ajaxurl,
                            data: {
                                id: id,
                                datajson: dataStr,
                                type: $(".type1").val()
                            },

                            success: function () {
                                getAllPage();
                                page = num;
                                goods("../product/GetProductsByPage_get?type="+data.Type, page);
                            }
                        });
                    }
                }
                window.wxc.xcConfirm(txt, "custom", option);
            },
            dataType: "json"
        });
    });


</script>

</body>

</html>
